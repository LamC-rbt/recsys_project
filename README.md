# Movie Recommendation

## Цель проекта
Разработать алгоритм для рекомендации фильмов на основе истории взаимодействий пользователя.
- В качестве метрик для оценки качества рекомендаций используются Recall@1, Recall@10, NDCG@10. Цель — достичь NDCG@10 выше 0.1.
- Для бесшовного взаимодействия пользователя с сервисом время обработки пользователя не должно превышать 100 мс.

---

## Набор данных
- Используется открытый датасет MovieLens-1m, содержащий более $10^6$ взаимодействий пользователя с фильмами.
- Для рекомендации на основе истории пользователя берется только информация о взаимодействии с фильмами.
- Данные были очищены от шумных взаимодействий (пользователей, оценивших менее 5 фильмов).
- Валидационные метки — предпоследние взаимодействия случайных 512 пользователей.
- Данные для тестирования — последние взаимодействия всех пользователей.

---

## План экспериментов
1. Baseline модель — SASRec.  
2. Подбор гиперпараметров.  
3. Калибровка оценки вероятности взаимодействия пользователя с фильмом.  
4. Оценка по метрикам Recall@1, Recall@10, NDCG@10.  

---

## Запуск проекта
Склонируйте репозиторий и перейдите в его корневую директорию.

### Установка зависимостей
```bash
pip install -r requirements.txt
```

### Обучение модели
```bash
!PYTHONPATH=. python  ./scripts/train.py --config=./config_sasrec.py --config_hyper=./config_training.py
```

В качестве ***config*** и ***config_hyper*** возможно передать свою конфигурацию модели и гиперпараметры обучения соответственно.

### Оценка качества
```bash
!PYTHONPATH=. python ./scripts/evaluate.py --config=./config_sasrec.py --config_hyper=./config_training.py --checkpoint=/content/recsys_project/checkpoints/gsasrec-MovieLens_Large-step:10848-negs:1-emb:128-dropout:0.5-metric:0.062810.pt
```
В качестве чекпоинта можно также передать свою сохраненную модель с соответствующей конфигурацией.

## Текущие метрики
| Model  | Loss | Recall@1 | Recall@10 | NDCG@10 |
|---------|------|-----------|------------|----------|
| SASRec | BCE  | 0.0260    | 0.1504     | 0.0771   |
